function q = q_ana(k_final,t_hop)

q = [];
ii = 0;
for ii = 1:numel(k_final)
    
    kk = k_final(ii);
    
    
    if t_hop == 0
    q(ii) = 0.356379E1.*acos((1/2).*(((-0.278401E-1)+sqrt(-1)*0.E-323).*( ...
      0.306E-1+(0.E-323+sqrt(-1)*(-0.693541E1)).*kk.^(-1)+(0.E-323+sqrt( ...
      -1)*0.9515E-1).*kk).^(-2).*sin(0.7015E-1.*kk).^2.*(0.E-323+sin( ...
      0.7015E-1.*kk)).^(-2)+exp(1).^((0.E-323+sqrt(-1)*(-0.2806E0)).*kk).* ...
      (1+(-0.117983E0).*(0.306E-1+(0.E-323+sqrt(-1)*(-0.693541E1)).*kk.^( ...
      -1)+(0.E-323+sqrt(-1)*0.9515E-1).*kk).^(-1).*sin(0.7015E-1.*kk).*( ...
      0.E-323+sin(0.7015E-1.*kk)).^(-1)).^2+exp(1).^((0.E-323+sqrt(-1)* ...
      0.2806E0).*kk).*(1+0.117983E0.*(0.306E-1+(0.E-323+sqrt(-1)*( ...
      -0.693541E1)).*kk.^(-1)+(0.E-323+sqrt(-1)*0.9515E-1).*kk).^(-1).* ...
      sin(0.7015E-1.*kk).*(0.E-323+sin(0.7015E-1.*kk)).^(-1)).^2));

    elseif t_hop == 0.25

    q(ii) = 0.356379E1.*acos((1/2).*((-0.1392E-1).*exp(1).^((0.E-323+sqrt(-1)* ...
      (-0.35075E-1)).*kk).*(0.306E-1+(0.E-323+sqrt(-1)*(-0.693541E1)).* ...
      kk.^(-1)+(0.E-323+sqrt(-1)*0.9515E-1).*kk).^(-2).*(2.^(1/2).*norm( ...
      2.^(-1/2).*exp(1).^((0.E-323+sqrt(-1)*(-0.7015E-1)).*kk)+2.^(-1/2) ...
      .*exp(1).^((0.E-323+sqrt(-1)*0.7015E-1).*kk)).^(-1).*sin( ...
      0.175375E-1.*kk)+sin(0.526125E-1.*kk)).^(-2).*sin(0.7015E-1.*kk).^2+( ...
      -0.1392E-1).*exp(1).^((0.E-323+sqrt(-1)*0.35075E-1).*kk).*( ...
      0.306E-1+(0.E-323+sqrt(-1)*(-0.693541E1)).*kk.^(-1)+(0.E-323+sqrt( ...
      -1)*0.9515E-1).*kk).^(-2).*(2.^(1/2).*norm(2.^(-1/2).*exp(1).^(( ...
      0.E-323+sqrt(-1)*(-0.7015E-1)).*kk)+2.^(-1/2).*exp(1).^((0.E-323+ ...
      sqrt(-1)*0.7015E-1).*kk)).^(-1).*sin(0.175375E-1.*kk)+sin( ...
      0.526125E-1.*kk)).^(-2).*sin(0.7015E-1.*kk).^2+exp(1).^((0.E-323+ ...
      sqrt(-1)*(-0.2806E0)).*kk).*(1+(-0.117983E0).*(0.306E-1+(0.E-323+ ...
      sqrt(-1)*(-0.693541E1)).*kk.^(-1)+(0.E-323+sqrt(-1)*0.9515E-1).*kk) ...
      .^(-1).*(2.^(1/2).*norm(2.^(-1/2).*exp(1).^((0.E-323+sqrt(-1)*( ...
      -0.7015E-1)).*kk)+2.^(-1/2).*exp(1).^((0.E-323+sqrt(-1)*0.7015E-1) ...
      .*kk)).^(-1).*sin(0.175375E-1.*kk)+sin(0.526125E-1.*kk)).^(-1).*sin( ...
      0.7015E-1.*kk)).^2+exp(1).^((0.E-323+sqrt(-1)*0.2806E0).*kk).*(1+ ...
      0.117983E0.*(0.306E-1+(0.E-323+sqrt(-1)*(-0.693541E1)).*kk.^(-1)+( ...
      0.E-323+sqrt(-1)*0.9515E-1).*kk).^(-1).*(2.^(1/2).*norm(2.^(-1/2).* ...
      exp(1).^((0.E-323+sqrt(-1)*(-0.7015E-1)).*kk)+2.^(-1/2).*exp(1).^(( ...
      0.E-323+sqrt(-1)*0.7015E-1).*kk)).^(-1).*sin(0.175375E-1.*kk)+sin( ...
      0.526125E-1.*kk)).^(-1).*sin(0.7015E-1.*kk)).^2));

    elseif t_hop == 0.5

    q(ii) = 0.356379E1.*acos((1/2).*((-0.1392E-1).*exp(1).^((0.E-323+sqrt(-1)* ...
      (-0.7015E-1)).*kk).*(0.306E-1+(0.E-323+sqrt(-1)*(-0.693541E1)).* ...
      kk.^(-1)+(0.E-323+sqrt(-1)*0.9515E-1).*kk).^(-2).*(sin(0.35075E-1.* ...
      kk)+2.^(1/2).*norm(2.^(-1/2).*exp(1).^((0.E-323+sqrt(-1)*( ...
      -0.7015E-1)).*kk)+2.^(-1/2).*exp(1).^((0.E-323+sqrt(-1)*0.7015E-1) ...
      .*kk)).^(-1).*sin(0.35075E-1.*kk)).^(-2).*sin(0.7015E-1.*kk).^2+( ...
      -0.1392E-1).*exp(1).^((0.E-323+sqrt(-1)*0.7015E-1).*kk).*(0.306E-1+ ...
      (0.E-323+sqrt(-1)*(-0.693541E1)).*kk.^(-1)+(0.E-323+sqrt(-1)* ...
      0.9515E-1).*kk).^(-2).*(sin(0.35075E-1.*kk)+2.^(1/2).*norm(2.^(-1/2) ...
      .*exp(1).^((0.E-323+sqrt(-1)*(-0.7015E-1)).*kk)+2.^(-1/2).*exp(1) ...
      .^((0.E-323+sqrt(-1)*0.7015E-1).*kk)).^(-1).*sin(0.35075E-1.*kk)).^( ...
      -2).*sin(0.7015E-1.*kk).^2+exp(1).^((0.E-323+sqrt(-1)*(-0.2806E0)) ...
      .*kk).*(1+(-0.117983E0).*(0.306E-1+(0.E-323+sqrt(-1)*(-0.693541E1)) ...
      .*kk.^(-1)+(0.E-323+sqrt(-1)*0.9515E-1).*kk).^(-1).*(sin( ...
      0.35075E-1.*kk)+2.^(1/2).*norm(2.^(-1/2).*exp(1).^((0.E-323+sqrt( ...
      -1)*(-0.7015E-1)).*kk)+2.^(-1/2).*exp(1).^((0.E-323+sqrt(-1)* ...
      0.7015E-1).*kk)).^(-1).*sin(0.35075E-1.*kk)).^(-1).*sin(0.7015E-1.* ...
      kk)).^2+exp(1).^((0.E-323+sqrt(-1)*0.2806E0).*kk).*(1+0.117983E0.*( ...
      0.306E-1+(0.E-323+sqrt(-1)*(-0.693541E1)).*kk.^(-1)+(0.E-323+sqrt( ...
      -1)*0.9515E-1).*kk).^(-1).*(sin(0.35075E-1.*kk)+2.^(1/2).*norm(2.^( ...
      -1/2).*exp(1).^((0.E-323+sqrt(-1)*(-0.7015E-1)).*kk)+2.^(-1/2).* ...
      exp(1).^((0.E-323+sqrt(-1)*0.7015E-1).*kk)).^(-1).*sin(0.35075E-1.* ...
      kk)).^(-1).*sin(0.7015E-1.*kk)).^2));

    elseif t_hop == 0.75

    q(ii) = 0.356379E1.*acos((1/2).*((-0.1392E-1).*exp(1).^((0.E-323+sqrt(-1)* ...
      (-0.105225E0)).*kk).*(0.306E-1+(0.E-323+sqrt(-1)*(-0.693541E1)).* ...
      kk.^(-1)+(0.E-323+sqrt(-1)*0.9515E-1).*kk).^(-2).*(sin(0.175375E-1.* ...
      kk)+2.^(1/2).*norm(2.^(-1/2).*exp(1).^((0.E-323+sqrt(-1)*( ...
      -0.7015E-1)).*kk)+2.^(-1/2).*exp(1).^((0.E-323+sqrt(-1)*0.7015E-1) ...
      .*kk)).^(-1).*sin(0.526125E-1.*kk)).^(-2).*sin(0.7015E-1.*kk).^2+( ...
      -0.1392E-1).*exp(1).^((0.E-323+sqrt(-1)*0.105225E0).*kk).*( ...
      0.306E-1+(0.E-323+sqrt(-1)*(-0.693541E1)).*kk.^(-1)+(0.E-323+sqrt( ...
      -1)*0.9515E-1).*kk).^(-2).*(sin(0.175375E-1.*kk)+2.^(1/2).*norm(2.^( ...
      -1/2).*exp(1).^((0.E-323+sqrt(-1)*(-0.7015E-1)).*kk)+2.^(-1/2).* ...
      exp(1).^((0.E-323+sqrt(-1)*0.7015E-1).*kk)).^(-1).*sin( ...
      0.526125E-1.*kk)).^(-2).*sin(0.7015E-1.*kk).^2+exp(1).^((0.E-323+ ...
      sqrt(-1)*(-0.2806E0)).*kk).*(1+(-0.117983E0).*(0.306E-1+(0.E-323+ ...
      sqrt(-1)*(-0.693541E1)).*kk.^(-1)+(0.E-323+sqrt(-1)*0.9515E-1).*kk) ...
      .^(-1).*(sin(0.175375E-1.*kk)+2.^(1/2).*norm(2.^(-1/2).*exp(1).^(( ...
      0.E-323+sqrt(-1)*(-0.7015E-1)).*kk)+2.^(-1/2).*exp(1).^((0.E-323+ ...
      sqrt(-1)*0.7015E-1).*kk)).^(-1).*sin(0.526125E-1.*kk)).^(-1).*sin( ...
      0.7015E-1.*kk)).^2+exp(1).^((0.E-323+sqrt(-1)*0.2806E0).*kk).*(1+ ...
      0.117983E0.*(0.306E-1+(0.E-323+sqrt(-1)*(-0.693541E1)).*kk.^(-1)+( ...
      0.E-323+sqrt(-1)*0.9515E-1).*kk).^(-1).*(sin(0.175375E-1.*kk)+2.^( ...
      1/2).*norm(2.^(-1/2).*exp(1).^((0.E-323+sqrt(-1)*(-0.7015E-1)).*kk) ...
      +2.^(-1/2).*exp(1).^((0.E-323+sqrt(-1)*0.7015E-1).*kk)).^(-1).*sin( ...
      0.526125E-1.*kk)).^(-1).*sin(0.7015E-1.*kk)).^2));

    elseif t_hop == 1

    q(ii) = 0.356379E1.*acos((1/2).*((-0.1392E-1).*exp(1).^((0.E-323+sqrt(-1)* ...
      (-0.1403E0)).*kk).*(0.306E-1+(0.E-323+sqrt(-1)*(-0.693541E1)).*kk.^( ...
      -1)+(0.E-323+sqrt(-1)*0.9515E-1).*kk).^(-2).*sin(0.7015E-1.*kk).^2.* ...
      (0.E-323+2.^(1/2).*norm(2.^(-1/2).*exp(1).^((0.E-323+sqrt(-1)*( ...
      -0.7015E-1)).*kk)+2.^(-1/2).*exp(1).^((0.E-323+sqrt(-1)*0.7015E-1) ...
      .*kk)).^(-1).*sin(0.7015E-1.*kk)).^(-2)+(-0.1392E-1).*exp(1).^(( ...
      0.E-323+sqrt(-1)*0.1403E0).*kk).*(0.306E-1+(0.E-323+sqrt(-1)*( ...
      -0.693541E1)).*kk.^(-1)+(0.E-323+sqrt(-1)*0.9515E-1).*kk).^(-2).* ...
      sin(0.7015E-1.*kk).^2.*(0.E-323+2.^(1/2).*norm(2.^(-1/2).*exp(1).^( ...
      (0.E-323+sqrt(-1)*(-0.7015E-1)).*kk)+2.^(-1/2).*exp(1).^((0.E-323+ ...
      sqrt(-1)*0.7015E-1).*kk)).^(-1).*sin(0.7015E-1.*kk)).^(-2)+exp(1).^( ...
      (0.E-323+sqrt(-1)*(-0.2806E0)).*kk).*(1+(-0.117983E0).*(0.306E-1+( ...
      0.E-323+sqrt(-1)*(-0.693541E1)).*kk.^(-1)+(0.E-323+sqrt(-1)* ...
      0.9515E-1).*kk).^(-1).*sin(0.7015E-1.*kk).*(0.E-323+2.^(1/2).*norm( ...
      2.^(-1/2).*exp(1).^((0.E-323+sqrt(-1)*(-0.7015E-1)).*kk)+2.^(-1/2) ...
      .*exp(1).^((0.E-323+sqrt(-1)*0.7015E-1).*kk)).^(-1).*sin( ...
      0.7015E-1.*kk)).^(-1)).^2+exp(1).^((0.E-323+sqrt(-1)*0.2806E0).*kk) ...
      .*(1+0.117983E0.*(0.306E-1+(0.E-323+sqrt(-1)*(-0.693541E1)).*kk.^( ...
      -1)+(0.E-323+sqrt(-1)*0.9515E-1).*kk).^(-1).*sin(0.7015E-1.*kk).*( ...
      0.E-323+2.^(1/2).*norm(2.^(-1/2).*exp(1).^((0.E-323+sqrt(-1)*( ...
      -0.7015E-1)).*kk)+2.^(-1/2).*exp(1).^((0.E-323+sqrt(-1)*0.7015E-1) ...
      .*kk)).^(-1).*sin(0.7015E-1.*kk)).^(-1)).^2));

    else
        q = [];
    fprintf("%%% Something went wrong. Please try again.\n")
    end

end

end
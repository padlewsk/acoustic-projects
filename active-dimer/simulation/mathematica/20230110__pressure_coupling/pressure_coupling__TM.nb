(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 13.1' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     45445,       1063]
NotebookOptionsPosition[     43753,       1026]
NotebookOutlinePosition[     44176,       1043]
CellTagsIndexPosition[     44133,       1040]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{
  RowBox[{"ClearAll", "[", "\"\<Global`*\>\"", "]"}], ";"}]], "Input",
 CellLabel->
  "In[923]:=",ExpressionUUID->"801124ab-0fb5-448a-adb8-95a18c7e2d49"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"myEliminate", "[", 
    RowBox[{"sys_", ",", "var_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "sol", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"sol", "=", 
       RowBox[{
        RowBox[{"Solve", "[", 
         RowBox[{
          RowBox[{"sys", "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", "var"}], "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"sys", "[", 
        RowBox[{"[", 
         RowBox[{"2", ";;", 
          RowBox[{"-", "1"}]}], "]"}], "]"}], "/.", "sol"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 CellLabel->
  "In[924]:=",ExpressionUUID->"93da8c23-d7d5-458e-ad14-3e21b9a90adb"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Needs", "[", "\"\<ToMatlab`\>\"", "]"}], ";"}]}]], "Input",
 CellChangeTimes->{{3.908003275107726*^9, 3.908003279088045*^9}, {
   3.9080038355732565`*^9, 3.9080038590519657`*^9}, {3.9080041550865383`*^9, 
   3.908004157349861*^9}, 3.9080043664107323`*^9, 3.908004833236107*^9},
 CellLabel->
  "In[925]:=",ExpressionUUID->"b34892b9-64fb-4f01-b5cd-1ce48657d503"],

Cell[CellGroupData[{

Cell[TextData[StyleBox["Transfer matrix", "Subsection"]], "Section",
 CellChangeTimes->{{3.8710216689538574`*^9, 3.8710216720377874`*^9}, {
  3.871034860293949*^9, 3.871034861212222*^9}, {3.8711180030278296`*^9, 
  3.871118004194379*^9}},ExpressionUUID->"6a98240c-5431-415b-93e6-\
be8d9b7625b1"],

Cell[BoxData[
 RowBox[{"(*", "SYSTEM", "*)"}]], "Input",
 CellChangeTimes->{{3.8837368423255405`*^9, 3.8837369196615887`*^9}, {
   3.8837370509504805`*^9, 3.883737051869423*^9}, {3.883737417257803*^9, 
   3.883737435562806*^9}, {3.883737617935274*^9, 3.8837376533014073`*^9}, {
   3.8837376859602375`*^9, 3.883737690086417*^9}, {3.883737852322466*^9, 
   3.883737854721957*^9}, 3.883737927851155*^9, {3.8837405183935547`*^9, 
   3.8837405405596724`*^9}, {3.8837407227130384`*^9, 3.883740723402336*^9}, {
   3.8837407576206627`*^9, 3.8837407625257816`*^9}, {3.8843193942360525`*^9, 
   3.884319396729103*^9}, {3.890895485215558*^9, 3.890895491142044*^9}, {
   3.8908958396600885`*^9, 3.8908958490974307`*^9}, {3.890895886201034*^9, 
   3.8908959200083027`*^9}, {3.8909678960099373`*^9, 
   3.8909679245489345`*^9}, {3.8909683308478193`*^9, 3.890968331998746*^9}, 
   3.8909707216599207`*^9, {3.8909778813402557`*^9, 3.890977884891076*^9}, {
   3.8909788286520257`*^9, 3.8909788534084277`*^9}, {3.8909791479361753`*^9, 
   3.890979176089344*^9}, {3.8909792213529377`*^9, 3.8909792236472263`*^9}, {
   3.8909792690689487`*^9, 3.8909792775358095`*^9}, {3.8909793500979724`*^9, 
   3.8909793526248617`*^9}, {3.8909795140803375`*^9, 3.890979514670204*^9}, {
   3.8909800374909134`*^9, 3.8909800377939906`*^9}, {3.8909800829242015`*^9, 
   3.8909800965412464`*^9}, {3.8909802313028784`*^9, 
   3.8909802864558887`*^9}, {3.890980363335767*^9, 3.890980398384388*^9}, {
   3.8909806020124893`*^9, 3.890980603962332*^9}, {3.8909806649964743`*^9, 
   3.890980725434347*^9}, 3.8909807593179812`*^9, 3.8909808076507816`*^9, 
   3.8909808504397507`*^9, {3.8909809415737324`*^9, 3.8909809699083776`*^9}, {
   3.890981107903586*^9, 3.8909811330778575`*^9}, {3.8909813706275897`*^9, 
   3.890981373570181*^9}, {3.8909814147166357`*^9, 3.890981417521966*^9}, {
   3.890981607350313*^9, 3.890981639620098*^9}, {3.890981908018855*^9, 
   3.890981927978286*^9}, {3.8909820376614037`*^9, 3.890982081787075*^9}, {
   3.890982114191913*^9, 3.8909821291987734`*^9}, {3.8909821634486065`*^9, 
   3.890982203401134*^9}, {3.890982248760892*^9, 3.890982248970333*^9}, {
   3.8909822858116474`*^9, 3.890982473565951*^9}, {3.8909826634325266`*^9, 
   3.89098266928633*^9}, {3.890983831578765*^9, 3.890983863456756*^9}, {
   3.8909839002012167`*^9, 3.890983938907426*^9}, {3.89098398914909*^9, 
   3.890984004765303*^9}, {3.890984106843978*^9, 3.8909841730575275`*^9}, {
   3.8909842570367193`*^9, 3.8909842571751814`*^9}, {3.8909842976281595`*^9, 
   3.8909843737430983`*^9}, {3.8909845976359396`*^9, 
   3.8909846048000813`*^9}, {3.8909857818466206`*^9, 
   3.8909857882146683`*^9}, {3.890985978312668*^9, 3.890986004072392*^9}, {
   3.890986108850093*^9, 3.8909861118973684`*^9}, {3.8909864180600977`*^9, 
   3.890986457034957*^9}, {3.8909867362797136`*^9, 3.890986739677028*^9}, {
   3.890986775522134*^9, 3.890986791685197*^9}, {3.890986858497343*^9, 
   3.8909868611981707`*^9}, {3.8909870484363155`*^9, 3.8909870601198454`*^9}, 
   3.890991509541918*^9, {3.8909916699341016`*^9, 3.8909916769963665`*^9}, 
   3.8910758152614193`*^9, 3.907991377142957*^9, {3.9080033045891128`*^9, 
   3.908003306840184*^9}, {3.908003449006488*^9, 3.9080034565944767`*^9}, {
   3.908003889141556*^9, 3.908004035542188*^9}, {3.9080040830556307`*^9, 
   3.9080041310018377`*^9}, {3.908004353625992*^9, 3.908004361393008*^9}, {
   3.9080044560070457`*^9, 3.908004463107827*^9}, {3.9080049249621544`*^9, 
   3.9080049623267765`*^9}, {3.9080049924514*^9, 3.9080050669755125`*^9}, {
   3.9080051329584856`*^9, 3.9080051486107345`*^9}, 3.908005216630725*^9},
 CellLabel->
  "In[926]:=",ExpressionUUID->"44c34d5a-456a-47e2-8767-86445beabc62"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"sys", "=", 
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"sd", " ", "p1"}], "==", 
       RowBox[{
        RowBox[{
         RowBox[{"zs", "[", "k", "]"}], " ", "v1"}], "+", " ", 
        RowBox[{"bl", " ", "i1"}]}]}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"sd", " ", "p2"}], "==", 
       RowBox[{
        RowBox[{
         RowBox[{"zs", "[", "k", "]"}], " ", "v2"}], "+", " ", 
        RowBox[{"bl", " ", "i2"}]}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"p1", "==", 
       RowBox[{"a1R", "+", "b1R"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"p2", "==", 
       RowBox[{"a2L", "+", "b2L"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"a2L", "==", 
       RowBox[{"a1R", " ", 
        RowBox[{"Exp", "[", 
         RowBox[{
          RowBox[{"-", "\[ImaginaryI]"}], " ", "k", " ", 
          RowBox[{"a", "/", "2"}]}], "]"}]}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"b2L", "==", 
       RowBox[{"b1R", " ", 
        RowBox[{"Exp", "[", 
         RowBox[{
          RowBox[{"+", "\[ImaginaryI]"}], " ", "k", " ", 
          RowBox[{"a", "/", "2"}]}], "]"}]}]}]}], "\[IndentingNewLine]", 
     "}"}]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"CURRENT", " ", "CONTROL", " ", "SCHEME"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"sys", "=", 
    RowBox[{"sys", "/.", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"i1", "\[Rule]", " ", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"kk", "*", "p2"}], ")"}], "/", "bl"}]}], " ", ",", 
       "\[IndentingNewLine]", 
       RowBox[{"i2", "\[Rule]", " ", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"kk", "*", "p1"}], ")"}], "/", "bl"}]}]}], " ", 
      "\[IndentingNewLine]", "}"}]}]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"PRESSURE", " ", "CONTINUITY"}], "*)"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"sys", "=", 
    RowBox[{"sys", "/.", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"p1", "\[Rule]", 
        RowBox[{"a1L", "+", "b1L"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"p2", "\[Rule]", 
        RowBox[{"a2R", "+", "b2R"}]}]}], " ", "\[IndentingNewLine]", 
      "}"}]}]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"VOl", ".", " ", "FLOW"}], " ", "CONSERVATION"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"sys", "=", 
    RowBox[{"sys", "/.", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"v1", "->", 
        FractionBox[
         RowBox[{"a1L", "-", "b1L", "-", 
          RowBox[{"(", 
           RowBox[{"a1R", "-", "b1R"}], ")"}]}], "zr"]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"v2", "->", 
        FractionBox[
         RowBox[{"a2L", "-", "b2L", "-", 
          RowBox[{"(", 
           RowBox[{"a2R", "-", "b2R"}], ")"}]}], "zr"]}]}], 
      "\[IndentingNewLine]", "}"}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"sys", "=", 
   RowBox[{
    RowBox[{"myEliminate", "[", 
     RowBox[{"sys", ",", "a1R"}], "]"}], "//", "FullSimplify"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"sys", "=", 
   RowBox[{
    RowBox[{"myEliminate", "[", 
     RowBox[{"sys", ",", "a2L"}], "]"}], "//", "FullSimplify"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"sys", "=", 
   RowBox[{
    RowBox[{"myEliminate", "[", 
     RowBox[{"sys", ",", "b1R"}], "]"}], "//", "FullSimplify"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"sys", "=", 
    RowBox[{
     RowBox[{"myEliminate", "[", 
      RowBox[{"sys", ",", "b2L"}], "]"}], "//", "FullSimplify"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"sysSol", "=", 
    RowBox[{
     RowBox[{"Solve", "[", 
      RowBox[{"sys", ",", 
       RowBox[{"{", 
        RowBox[{"a2R", ",", "b2R"}], "}"}]}], "]"}], "//", "FullSimplify"}]}],
    ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"mMati", "=", 
    RowBox[{
     RowBox[{
      RowBox[{"Coefficient", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"(", GridBox[{
            {"a2R", "a2R"},
            {"b2R", "b2R"}
           }], ")"}], "/.", 
         RowBox[{"sysSol", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], ",", 
        RowBox[{"(", GridBox[{
           {"i1", "i2"},
           {"i1", "i2"}
          }], ")"}]}], "]"}], "//", "FullSimplify"}], "//", " ", 
     "MatrixForm"}]}], " ", 
   RowBox[{"(*", " ", 
    RowBox[{
    "coefs", " ", "for", " ", "current", " ", "i1", " ", "and", " ", "i2", 
     " ", "if", " ", "not", " ", "specified"}], "*)"}], "*)"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"mMat", "=", 
    RowBox[{
     RowBox[{"Coefficient", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"(", GridBox[{
           {"a2R", "a2R"},
           {"b2R", "b2R"}
          }], ")"}], "/.", 
        RowBox[{"sysSol", "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ",", 
       RowBox[{"(", GridBox[{
          {"a1L", "b1L"},
          {"a1L", "b1L"}
         }], ")"}]}], "]"}], "//", "Simplify"}]}], ";", " ", 
   RowBox[{"(*", 
    RowBox[{
    "change", " ", "to", " ", "Full", " ", "to", " ", "get", " ", "same", " ",
      "result", " ", "as", " ", "in", " ", "pressure_coupling", 
     RowBox[{"__main", ".", "nb"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"mMat", "//", " ", "MatrixForm"}]}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"mMat", "*", "2", " ", 
     RowBox[{"zs", "[", "k", "]"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", 
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{"\[ImaginaryI]", " ", "a", " ", "k"}]]}], ")"}], " ", "kk",
         " ", "zr"}], "+", 
       RowBox[{"2", " ", 
        SuperscriptBox["\[ExponentialE]", 
         FractionBox[
          RowBox[{"\[ImaginaryI]", " ", "a", " ", "k"}], "2"]], " ", 
        RowBox[{"zs", "[", "k", "]"}]}]}], ")"}]}], "//", "MatrixForm"}], 
   "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"just", " ", "a", " ", "check"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"sysSol", "[", 
      RowBox[{"[", 
       RowBox[{"1", ",", "1", ",", "2"}], "]"}], "]"}], " ", "\[Equal]", "  ", 
     RowBox[{
      RowBox[{
       RowBox[{"mMati", "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", "1"}], "]"}], "]"}], "*", "i1"}], " ", "+", "  ", 
      RowBox[{
       RowBox[{"mMati", "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", "2"}], "]"}], "]"}], "*", "i2"}], "+", " ", 
      RowBox[{
       RowBox[{"mMat", "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", "1"}], "]"}], "]"}], "*", "a1L"}], "+", " ", 
      RowBox[{
       RowBox[{"mMat", "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", "2"}], "]"}], "]"}], "*", "b1L"}]}]}], "//", 
    "FullSimplify"}], "*)"}]}]}], "Input",
 CellChangeTimes->{{3.8837368423255405`*^9, 3.8837369196615887`*^9}, {
   3.8837370509504805`*^9, 3.883737051869423*^9}, {3.883737417257803*^9, 
   3.883737435562806*^9}, {3.883737617935274*^9, 3.8837376533014073`*^9}, {
   3.8837376859602375`*^9, 3.883737690086417*^9}, {3.883737852322466*^9, 
   3.883737854721957*^9}, 3.883737927851155*^9, {3.8837405183935547`*^9, 
   3.8837405405596724`*^9}, {3.8837407227130384`*^9, 3.883740723402336*^9}, {
   3.8837407576206627`*^9, 3.8837407625257816`*^9}, {3.8843193942360525`*^9, 
   3.884319396729103*^9}, {3.890895485215558*^9, 3.890895491142044*^9}, {
   3.8908958396600885`*^9, 3.8908958490974307`*^9}, {3.890895886201034*^9, 
   3.8908959200083027`*^9}, {3.8909678960099373`*^9, 
   3.8909679245489345`*^9}, {3.8909683308478193`*^9, 3.890968331998746*^9}, 
   3.8909707216599207`*^9, {3.8909778813402557`*^9, 3.890977884891076*^9}, {
   3.8909788286520257`*^9, 3.8909788534084277`*^9}, {3.8909791479361753`*^9, 
   3.890979176089344*^9}, {3.8909792213529377`*^9, 3.8909792236472263`*^9}, {
   3.8909792690689487`*^9, 3.8909792775358095`*^9}, {3.8909793500979724`*^9, 
   3.8909793526248617`*^9}, {3.8909795140803375`*^9, 3.890979514670204*^9}, {
   3.8909800374909134`*^9, 3.8909800377939906`*^9}, {3.8909800829242015`*^9, 
   3.8909800965412464`*^9}, {3.8909802313028784`*^9, 
   3.8909802864558887`*^9}, {3.890980363335767*^9, 3.890980398384388*^9}, {
   3.8909806020124893`*^9, 3.890980603962332*^9}, {3.8909806649964743`*^9, 
   3.890980725434347*^9}, 3.8909807593179812`*^9, 3.8909808076507816`*^9, 
   3.8909808504397507`*^9, {3.8909809415737324`*^9, 3.8909809699083776`*^9}, {
   3.890981107903586*^9, 3.8909811330778575`*^9}, {3.8909813706275897`*^9, 
   3.890981373570181*^9}, {3.8909814147166357`*^9, 3.890981417521966*^9}, {
   3.890981607350313*^9, 3.890981639620098*^9}, {3.890981908018855*^9, 
   3.890981927978286*^9}, {3.8909820376614037`*^9, 3.890982081787075*^9}, {
   3.890982114191913*^9, 3.8909821291987734`*^9}, {3.8909821634486065`*^9, 
   3.890982203401134*^9}, {3.890982248760892*^9, 3.890982248970333*^9}, {
   3.8909822858116474`*^9, 3.890982473565951*^9}, {3.8909826634325266`*^9, 
   3.89098266928633*^9}, {3.890983831578765*^9, 3.890983863456756*^9}, {
   3.8909839002012167`*^9, 3.890983938907426*^9}, {3.89098398914909*^9, 
   3.890984004765303*^9}, {3.890984106843978*^9, 3.8909841730575275`*^9}, {
   3.8909842570367193`*^9, 3.8909842571751814`*^9}, {3.8909842976281595`*^9, 
   3.8909843737430983`*^9}, {3.8909845976359396`*^9, 
   3.8909846048000813`*^9}, {3.8909857818466206`*^9, 
   3.8909857882146683`*^9}, {3.890985978312668*^9, 3.890986004072392*^9}, {
   3.890986108850093*^9, 3.8909861118973684`*^9}, {3.8909864180600977`*^9, 
   3.890986457034957*^9}, {3.8909867362797136`*^9, 3.890986739677028*^9}, {
   3.890986775522134*^9, 3.890986791685197*^9}, {3.890986858497343*^9, 
   3.8909868611981707`*^9}, {3.8909870484363155`*^9, 3.8909870601198454`*^9}, 
   3.890991509541918*^9, {3.8909916699341016`*^9, 3.8909916769963665`*^9}, 
   3.8910758152614193`*^9, 3.907991377142957*^9, {3.9080033045891128`*^9, 
   3.908003306840184*^9}, {3.908003449006488*^9, 3.9080034565944767`*^9}, {
   3.908003889141556*^9, 3.908004035542188*^9}, {3.9080040830556307`*^9, 
   3.9080041310018377`*^9}, {3.908004353625992*^9, 3.908004361393008*^9}, {
   3.9080044560070457`*^9, 3.908004463107827*^9}, {3.9080049249621544`*^9, 
   3.9080049623267765`*^9}, {3.9080049924514*^9, 3.9080050669755125`*^9}, {
   3.9080051329584856`*^9, 3.9080051486107345`*^9}, {3.908005216630725*^9, 
   3.908005225444174*^9}, {3.9080053074305463`*^9, 3.9080053836306286`*^9}, 
   3.908005745219103*^9, {3.908005809274643*^9, 3.9080058486406393`*^9}, 
   3.908005930430433*^9, {3.9080062707998986`*^9, 3.9080062713339605`*^9}, 
   3.9080063717046227`*^9, {3.9080129165649123`*^9, 3.9080129180813694`*^9}, 
   3.9080129516670556`*^9, {3.9080130020662985`*^9, 3.9080130848034773`*^9}, {
   3.9080137880667343`*^9, 3.908013788895039*^9}, {3.908013855367538*^9, 
   3.908013875996581*^9}, {3.9080142506824503`*^9, 3.9080142798983145`*^9}, {
   3.9107770826296787`*^9, 3.9107770847714276`*^9}, {3.9107797120704584`*^9, 
   3.910779726272361*^9}, {3.910779775617586*^9, 3.9107797899052315`*^9}, {
   3.910779917890723*^9, 3.910779958750677*^9}},
 CellLabel->
  "In[927]:=",ExpressionUUID->"36dd4bb9-63dd-4176-97f7-6d4b67e210d6"],

Ce,

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      FractionBox[
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", 
           SuperscriptBox["\[ExponentialE]", 
            RowBox[{"\[ImaginaryI]", " ", "a", " ", "k"}]]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["kk", "2"], "-", 
           SuperscriptBox["sd", "2"]}], ")"}], " ", 
         SuperscriptBox["zr", "2"]}], "+", 
        RowBox[{"4", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            SuperscriptBox["\[ExponentialE]", 
             FractionBox[
              RowBox[{"\[ImaginaryI]", " ", "a", " ", "k"}], "2"]], " ", 
            "kk"}], "-", "sd"}], ")"}], " ", "zr", " ", 
         RowBox[{"zs", "[", "k", "]"}]}], "+", 
        RowBox[{"4", " ", 
         SuperscriptBox[
          RowBox[{"zs", "[", "k", "]"}], "2"]}]}], 
       RowBox[{"2", " ", 
        RowBox[{"zs", "[", "k", "]"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", 
             SuperscriptBox["\[ExponentialE]", 
              RowBox[{"\[ImaginaryI]", " ", "a", " ", "k"}]]}], ")"}], " ", 
           "kk", " ", "zr"}], "+", 
          RowBox[{"2", " ", 
           SuperscriptBox["\[ExponentialE]", 
            FractionBox[
             RowBox[{"\[ImaginaryI]", " ", "a", " ", "k"}], "2"]], " ", 
           RowBox[{"zs", "[", "k", "]"}]}]}], ")"}]}]], 
      FractionBox[
       RowBox[{"zr", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", 
             SuperscriptBox["\[ExponentialE]", 
              RowBox[{"\[ImaginaryI]", " ", "a", " ", "k"}]]}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox["kk", "2"], "-", 
             SuperscriptBox["sd", "2"]}], ")"}], " ", "zr"}], "-", 
          RowBox[{"2", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "2"}], " ", 
              SuperscriptBox["\[ExponentialE]", 
               FractionBox[
                RowBox[{"\[ImaginaryI]", " ", "a", " ", "k"}], "2"]], " ", 
              "kk"}], "+", "sd", "+", 
             RowBox[{
              SuperscriptBox["\[ExponentialE]", 
               RowBox[{"\[ImaginaryI]", " ", "a", " ", "k"}]], " ", "sd"}]}], 
            ")"}], " ", 
           RowBox[{"zs", "[", "k", "]"}]}]}], ")"}]}], 
       RowBox[{"2", " ", 
        RowBox[{"zs", "[", "k", "]"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", 
             SuperscriptBox["\[ExponentialE]", 
              RowBox[{"\[ImaginaryI]", " ", "a", " ", "k"}]]}], ")"}], " ", 
           "kk", " ", "zr"}], "+", 
          RowBox[{"2", " ", 
           SuperscriptBox["\[ExponentialE]", 
            FractionBox[
             RowBox[{"\[ImaginaryI]", " ", "a", " ", "k"}], "2"]], " ", 
           RowBox[{"zs", "[", "k", "]"}]}]}], ")"}]}]]},
     {
      RowBox[{"-", 
       FractionBox[
        RowBox[{"zr", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1"}], "+", 
              SuperscriptBox["\[ExponentialE]", 
               RowBox[{"\[ImaginaryI]", " ", "a", " ", "k"}]]}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox["kk", "2"], "-", 
              SuperscriptBox["sd", "2"]}], ")"}], " ", "zr"}], "-", 
           RowBox[{"2", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"-", "2"}], " ", 
               SuperscriptBox["\[ExponentialE]", 
                FractionBox[
                 RowBox[{"\[ImaginaryI]", " ", "a", " ", "k"}], "2"]], " ", 
               "kk"}], "+", "sd", "+", 
              RowBox[{
               SuperscriptBox["\[ExponentialE]", 
                RowBox[{"\[ImaginaryI]", " ", "a", " ", "k"}]], " ", "sd"}]}],
              ")"}], " ", 
            RowBox[{"zs", "[", "k", "]"}]}]}], ")"}]}], 
        RowBox[{"2", " ", 
         RowBox[{"zs", "[", "k", "]"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1"}], "+", 
              SuperscriptBox["\[ExponentialE]", 
               RowBox[{"\[ImaginaryI]", " ", "a", " ", "k"}]]}], ")"}], " ", 
            "kk", " ", "zr"}], "+", 
           RowBox[{"2", " ", 
            SuperscriptBox["\[ExponentialE]", 
             FractionBox[
              RowBox[{"\[ImaginaryI]", " ", "a", " ", "k"}], "2"]], " ", 
            RowBox[{"zs", "[", "k", "]"}]}]}], ")"}]}]]}], 
      FractionBox[
       RowBox[{
        RowBox[{
         RowBox[{"-", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", 
            SuperscriptBox["\[ExponentialE]", 
             RowBox[{"\[ImaginaryI]", " ", "a", " ", "k"}]]}], ")"}]}], " ", 
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["kk", "2"], "-", 
           SuperscriptBox["sd", "2"]}], ")"}], " ", 
         SuperscriptBox["zr", "2"]}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "4"}], " ", 
            SuperscriptBox["\[ExponentialE]", 
             FractionBox[
              RowBox[{"\[ImaginaryI]", " ", "a", " ", "k"}], "2"]], " ", "kk",
             " ", "zr"}], "+", 
           RowBox[{"4", " ", 
            SuperscriptBox["\[ExponentialE]", 
             RowBox[{"\[ImaginaryI]", " ", "a", " ", "k"}]], " ", "sd", " ", 
            "zr"}]}], ")"}], " ", 
         RowBox[{"zs", "[", "k", "]"}]}], "+", 
        RowBox[{"4", " ", 
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{"\[ImaginaryI]", " ", "a", " ", "k"}]], " ", 
         SuperscriptBox[
          RowBox[{"zs", "[", "k", "]"}], "2"]}]}], 
       RowBox[{"2", " ", 
        RowBox[{"zs", "[", "k", "]"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", 
             SuperscriptBox["\[ExponentialE]", 
              RowBox[{"\[ImaginaryI]", " ", "a", " ", "k"}]]}], ")"}], " ", 
           "kk", " ", "zr"}], "+", 
          RowBox[{"2", " ", 
           SuperscriptBox["\[ExponentialE]", 
            FractionBox[
             RowBox[{"\[ImaginaryI]", " ", "a", " ", "k"}], "2"]], " ", 
           RowBox[{"zs", "[", "k", "]"}]}]}], ")"}]}]]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.9107798021579432`*^9, 3.9107799333660307`*^9, 
  3.91077997746222*^9},
 CellLabel->
  "Out[936]//MatrixForm=",ExpressionUUID->"23378145-af80-4611-866c-\
61d20178896c"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"TO", " ", "MATLAB", "\[IndentingNewLine]", 
     RowBox[{"Part", "[", 
      RowBox[{"mMat", ",", "1", ",", "1"}], "]"}]}], "//", "ToMatlab"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "*)"}]}]], "Input",
 CellChangeTimes->{{3.8837368423255405`*^9, 3.8837369196615887`*^9}, {
   3.8837370509504805`*^9, 3.883737051869423*^9}, {3.883737417257803*^9, 
   3.883737435562806*^9}, {3.883737617935274*^9, 3.8837376533014073`*^9}, {
   3.8837376859602375`*^9, 3.883737690086417*^9}, {3.883737852322466*^9, 
   3.883737854721957*^9}, 3.883737927851155*^9, {3.8837405183935547`*^9, 
   3.8837405405596724`*^9}, {3.8837407227130384`*^9, 3.883740723402336*^9}, {
   3.8837407576206627`*^9, 3.8837407625257816`*^9}, {3.8843193942360525`*^9, 
   3.884319396729103*^9}, {3.890895485215558*^9, 3.890895491142044*^9}, {
   3.8908958396600885`*^9, 3.8908958490974307`*^9}, {3.890895886201034*^9, 
   3.8908959200083027`*^9}, {3.8909678960099373`*^9, 
   3.8909679245489345`*^9}, {3.8909683308478193`*^9, 3.890968331998746*^9}, 
   3.8909707216599207`*^9, {3.8909778813402557`*^9, 3.890977884891076*^9}, {
   3.8909788286520257`*^9, 3.8909788534084277`*^9}, {3.8909791479361753`*^9, 
   3.890979176089344*^9}, {3.8909792213529377`*^9, 3.8909792236472263`*^9}, {
   3.8909792690689487`*^9, 3.8909792775358095`*^9}, {3.8909793500979724`*^9, 
   3.8909793526248617`*^9}, {3.8909795140803375`*^9, 3.890979514670204*^9}, {
   3.8909800374909134`*^9, 3.8909800377939906`*^9}, {3.8909800829242015`*^9, 
   3.8909800965412464`*^9}, {3.8909802313028784`*^9, 
   3.8909802864558887`*^9}, {3.890980363335767*^9, 3.890980398384388*^9}, {
   3.8909806020124893`*^9, 3.890980603962332*^9}, {3.8909806649964743`*^9, 
   3.890980725434347*^9}, 3.8909807593179812`*^9, 3.8909808076507816`*^9, 
   3.8909808504397507`*^9, {3.8909809415737324`*^9, 3.8909809699083776`*^9}, {
   3.890981107903586*^9, 3.8909811330778575`*^9}, {3.8909813706275897`*^9, 
   3.890981373570181*^9}, {3.8909814147166357`*^9, 3.890981417521966*^9}, {
   3.890981607350313*^9, 3.890981639620098*^9}, {3.890981908018855*^9, 
   3.890981927978286*^9}, {3.8909820376614037`*^9, 3.890982081787075*^9}, {
   3.890982114191913*^9, 3.8909821291987734`*^9}, {3.8909821634486065`*^9, 
   3.890982203401134*^9}, {3.890982248760892*^9, 3.890982248970333*^9}, {
   3.8909822858116474`*^9, 3.890982473565951*^9}, {3.8909826634325266`*^9, 
   3.89098266928633*^9}, {3.890983831578765*^9, 3.890983863456756*^9}, {
   3.8909839002012167`*^9, 3.890983938907426*^9}, {3.89098398914909*^9, 
   3.890984004765303*^9}, {3.890984106843978*^9, 3.8909841730575275`*^9}, {
   3.8909842570367193`*^9, 3.8909842571751814`*^9}, {3.8909842976281595`*^9, 
   3.8909843737430983`*^9}, {3.8909845976359396`*^9, 
   3.8909846048000813`*^9}, {3.8909857818466206`*^9, 
   3.8909857882146683`*^9}, {3.890985978312668*^9, 3.890986004072392*^9}, {
   3.890986108850093*^9, 3.8909861118973684`*^9}, {3.8909864180600977`*^9, 
   3.890986457034957*^9}, {3.8909867362797136`*^9, 3.890986739677028*^9}, {
   3.890986775522134*^9, 3.890986791685197*^9}, {3.890986858497343*^9, 
   3.8909868611981707`*^9}, {3.8909870484363155`*^9, 3.8909870601198454`*^9}, 
   3.890991509541918*^9, {3.8909916699341016`*^9, 3.8909916769963665`*^9}, 
   3.8910758152614193`*^9, 3.907991377142957*^9, {3.9080033045891128`*^9, 
   3.908003306840184*^9}, {3.908003449006488*^9, 3.9080034565944767`*^9}, {
   3.908003889141556*^9, 3.908004035542188*^9}, {3.9080040830556307`*^9, 
   3.9080041310018377`*^9}, {3.908004353625992*^9, 3.908004361393008*^9}, {
   3.9080044560070457`*^9, 3.908004463107827*^9}, {3.9080049249621544`*^9, 
   3.9080049623267765`*^9}, {3.9080049924514*^9, 3.9080050669755125`*^9}, {
   3.9080051329584856`*^9, 3.9080051486107345`*^9}, {3.908005216630725*^9, 
   3.9080052780617294`*^9}, {3.908005317009779*^9, 3.9080053584411287`*^9}, {
   3.908005392640154*^9, 3.9080054329130507`*^9}, {3.90800546909581*^9, 
   3.9080058272658806`*^9}, {3.9080062736495733`*^9, 
   3.9080062934057837`*^9}, {3.908006374107688*^9, 3.9080063834865656`*^9}, 
   3.9080067502822104`*^9, {3.908012814436096*^9, 3.908012817632022*^9}, 
   3.9080129896205187`*^9, {3.908013752500204*^9, 3.908013773664707*^9}, 
   3.9080142908426857`*^9},
 CellLabel->
  "In[937]:=",ExpressionUUID->"fe231724-afe8-4134-9303-0a22369706fd"],

Cell[CellGroupData[{

Cell["Simplify Matrix", "Subsection",
 CellChangeTimes->{{3.8837350447727513`*^9, 3.8837350463889894`*^9}, {
  3.908013993232995*^9, 
  3.90801400876064*^9}},ExpressionUUID->"9929bd8f-4855-4def-bdb7-\
41bf4112b9ff"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"mMatSimp", "=", 
    RowBox[{
     FractionBox[
      RowBox[{"  ", "1"}], 
      RowBox[{"2", " ", 
       RowBox[{"zs", "[", "k", "]"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", 
            SuperscriptBox["\[ExponentialE]", 
             RowBox[{"\[ImaginaryI]", " ", "a", " ", "k"}]]}], ")"}], " ", 
          "kk", " ", "zr"}], "+", 
         RowBox[{"2", " ", 
          SuperscriptBox["\[ExponentialE]", 
           FractionBox[
            RowBox[{"\[ImaginaryI]", " ", "a", " ", "k"}], "2"]], " ", 
          RowBox[{"zs", "[", "k", "]"}]}]}], ")"}]}]], 
     TagBox[
      RowBox[{"(", "\[NoBreak]", GridBox[{
         {
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1"}], "+", 
              SuperscriptBox["\[ExponentialE]", 
               RowBox[{"\[ImaginaryI]", " ", "a", " ", "k"}]]}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox["kk", "2"], "-", 
              SuperscriptBox["sd", "2"]}], ")"}], " ", 
            SuperscriptBox["zr", "2"]}], "+", 
           RowBox[{"4", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  SuperscriptBox["\[ExponentialE]", 
                   FractionBox[
                    RowBox[{"\[ImaginaryI]", " ", "a", " ", "k"}], "2"]], " ",
                   "kk"}], "-", "sd"}], ")"}], " ", "zr", " ", 
               RowBox[{"zs", "[", "k", "]"}]}], "+", " ", 
              SuperscriptBox[
               RowBox[{"zs", "[", "k", "]"}], "2"]}], ")"}]}]}], 
          RowBox[{"zr", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "1"}], "+", 
                SuperscriptBox["\[ExponentialE]", 
                 RowBox[{"\[ImaginaryI]", " ", "a", " ", "k"}]]}], ")"}], " ", 
              RowBox[{"(", 
               RowBox[{
                SuperscriptBox["kk", "2"], "-", 
                SuperscriptBox["sd", "2"]}], ")"}], " ", "zr"}], "-", 
             RowBox[{"2", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", "2"}], " ", 
                 SuperscriptBox["\[ExponentialE]", 
                  FractionBox[
                   RowBox[{"\[ImaginaryI]", " ", "a", " ", "k"}], "2"]], " ", 
                 "kk"}], "+", "sd", "+", 
                RowBox[{
                 SuperscriptBox["\[ExponentialE]", 
                  RowBox[{"\[ImaginaryI]", " ", "a", " ", "k"}]], " ", 
                 "sd"}]}], ")"}], " ", 
              RowBox[{"zs", "[", "k", "]"}]}]}], ")"}]}]},
         {
          RowBox[{
           RowBox[{"-", "zr"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "1"}], "+", 
                SuperscriptBox["\[ExponentialE]", 
                 RowBox[{"\[ImaginaryI]", " ", "a", " ", "k"}]]}], ")"}], " ", 
              RowBox[{"(", 
               RowBox[{
                SuperscriptBox["kk", "2"], "-", 
                SuperscriptBox["sd", "2"]}], ")"}], " ", "zr"}], "-", 
             RowBox[{"2", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", "2"}], " ", 
                 SuperscriptBox["\[ExponentialE]", 
                  FractionBox[
                   RowBox[{"\[ImaginaryI]", " ", "a", " ", "k"}], "2"]], " ", 
                 "kk"}], "+", "sd", "+", 
                RowBox[{
                 SuperscriptBox["\[ExponentialE]", 
                  RowBox[{"\[ImaginaryI]", " ", "a", " ", "k"}]], " ", 
                 "sd"}]}], ")"}], " ", 
              RowBox[{"zs", "[", "k", "]"}]}]}], ")"}]}], 
          RowBox[{
           RowBox[{
            RowBox[{"-", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "1"}], "+", 
               SuperscriptBox["\[ExponentialE]", 
                RowBox[{"\[ImaginaryI]", " ", "a", " ", "k"}]]}], ")"}]}], 
            " ", 
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox["kk", "2"], "-", 
              SuperscriptBox["sd", "2"]}], ")"}], " ", 
            SuperscriptBox["zr", "2"]}], "+", " ", 
           RowBox[{
            SuperscriptBox["\[ExponentialE]", 
             RowBox[{"\[ImaginaryI]", " ", "a", " ", "k"}]], "4", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"-", 
                   SuperscriptBox["\[ExponentialE]", 
                    RowBox[{"-", 
                    FractionBox[
                    RowBox[{"\[ImaginaryI]", " ", "a", " ", "k"}], "2"]}]]}], 
                  " ", "kk"}], "+", " ", "sd"}], ")"}], " ", "zr", " ", 
               RowBox[{"zs", "[", "k", "]"}]}], "+", " ", 
              SuperscriptBox[
               RowBox[{"zs", "[", "k", "]"}], "2"]}], ")"}]}]}]}
        },
        GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.7]}, 
            Offset[0.27999999999999997`]}, "Rows" -> {
            Offset[0.2], {
             Offset[0.4]}, 
            Offset[0.2]}}], "\[NoBreak]", ")"}],
      Function[BoxForm`e$, 
       MatrixForm[BoxForm`e$]]]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MatrixForm", "[", "mMat", "]"}], "==", " ", 
   RowBox[{"MatrixForm", "[", "mMatSimp", "]"}]}], "//", 
  "FullSimplify"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.8711146385864906`*^9, 3.87111475545201*^9}, {
   3.871114785694455*^9, 3.871114876401267*^9}, 3.871114956216411*^9, {
   3.8711149916704626`*^9, 3.8711149982667847`*^9}, {3.8711150742057962`*^9, 
   3.871115149648*^9}, {3.8711151909998255`*^9, 3.87111521258841*^9}, {
   3.871115280305045*^9, 3.8711153992139673`*^9}, {3.8711154545129557`*^9, 
   3.8711155478163013`*^9}, {3.8711156017965283`*^9, 3.871115617296496*^9}, 
   3.8711156513522377`*^9, {3.8711156917396154`*^9, 3.8711157506526256`*^9}, {
   3.871115787506607*^9, 3.8711159126072645`*^9}, {3.871115951447177*^9, 
   3.871115991862946*^9}, {3.8711161109960155`*^9, 3.8711161187078924`*^9}, {
   3.871116182965702*^9, 3.8711161920354404`*^9}, {3.8711165124286404`*^9, 
   3.8711165744349613`*^9}, {3.871116649818637*^9, 3.871116730264999*^9}, {
   3.871116802870349*^9, 3.8711169025275006`*^9}, {3.8711169340141773`*^9, 
   3.871116934715392*^9}, {3.8711169928096395`*^9, 3.871117040610156*^9}, {
   3.8711171094850883`*^9, 3.871117117428254*^9}, {3.871117171270938*^9, 
   3.8711172610354395`*^9}, {3.8711173220177784`*^9, 
   3.8711173514578114`*^9}, {3.8711174118197255`*^9, 3.871117414702426*^9}, {
   3.87111744533012*^9, 3.8711174536035547`*^9}, {3.8711177080028076`*^9, 
   3.8711177584503183`*^9}, {3.8711185619757547`*^9, 3.87111859485421*^9}, 
   3.8837267043254375`*^9, {3.883728086931273*^9, 3.88372808859366*^9}, {
   3.8837301579459844`*^9, 3.8837302008328576`*^9}, {3.883730253435762*^9, 
   3.883730259057198*^9}, {3.883730300619032*^9, 3.883730428043256*^9}, {
   3.883730759161698*^9, 3.883730764890329*^9}, {3.8837313421336117`*^9, 
   3.8837313570557666`*^9}, 3.883731448287442*^9, {3.8837340188642836`*^9, 
   3.883734032043849*^9}, {3.890968287476306*^9, 3.890968315230142*^9}, {
   3.8909703915496674`*^9, 3.8909704428754287`*^9}, {3.890970481282998*^9, 
   3.890970589979154*^9}, {3.8909706800210495`*^9, 3.8909707045776787`*^9}, {
   3.8909707410585375`*^9, 3.890970762476206*^9}, {3.8909709814911785`*^9, 
   3.8909710068428316`*^9}, {3.8909711502724237`*^9, 3.890971151818508*^9}, {
   3.890971217388213*^9, 3.8909712473944454`*^9}, {3.890971319373172*^9, 
   3.8909713258685308`*^9}, {3.9080138233288207`*^9, 
   3.9080138333607583`*^9}, {3.908013889334529*^9, 3.908013893058893*^9}, {
   3.908013930965412*^9, 3.9080139844106965`*^9}, {3.9080141164103613`*^9, 
   3.9080141450687637`*^9}, {3.908016205106027*^9, 3.908016210712881*^9}, {
   3.908018866259506*^9, 3.9080188674718246`*^9}, {3.908019075613373*^9, 
   3.9080190809567194`*^9}},
 CellLabel->
  "In[938]:=",ExpressionUUID->"2dd8508d-a21d-4b1f-9d6a-86d27c563058"],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{{3.9080141255242434`*^9, 3.9080141458367167`*^9}, 
   3.908016049262537*^9, 3.9080160870471597`*^9, 3.908016211362256*^9, 
   3.90801893914317*^9, {3.9080190833918943`*^9, 3.9080190856614585`*^9}, 
   3.9107760850339894`*^9, 3.910778726929634*^9, 3.910779770318347*^9, 
   3.910779977732826*^9},
 CellLabel->
  "Out[939]=",ExpressionUUID->"9290dd16-5526-4666-84ce-f583cdb1c41a"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"a1", " ", ":=", " ", 
    RowBox[{"2", " ", 
     RowBox[{"zs", "[", "k", "]"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", 
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{"\[ImaginaryI]", " ", "a", " ", "k"}]]}], ")"}], " ", "kk",
         " ", "zr"}], "+", 
       RowBox[{"2", " ", 
        SuperscriptBox["\[ExponentialE]", 
         FractionBox[
          RowBox[{"\[ImaginaryI]", " ", "a", " ", "k"}], "2"]], " ", 
        RowBox[{"zs", "[", "k", "]"}]}]}], ")"}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"a2", " ", ":=", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"\[ImaginaryI]", " ", "a", " ", "k"}]]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox["kk", "2"], "-", 
       SuperscriptBox["sd", "2"]}], ")"}], " ", 
     SuperscriptBox["zr", "2"]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"a3", ":=", 
   RowBox[{"4", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SuperscriptBox["\[ExponentialE]", 
           FractionBox[
            RowBox[{"\[ImaginaryI]", " ", "a", " ", "k"}], "2"]], " ", "kk"}],
          "-", "sd"}], ")"}], " ", "zr", " ", 
       RowBox[{"zs", "[", "k", "]"}]}], "+", " ", 
      SuperscriptBox[
       RowBox[{"zs", "[", "k", "]"}], "2"]}], ")"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"a4", ":=", 
   RowBox[{"2", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "2"}], " ", 
       SuperscriptBox["\[ExponentialE]", 
        FractionBox[
         RowBox[{"\[ImaginaryI]", " ", "a", " ", "k"}], "2"]], " ", "kk"}], 
      "+", "sd", "+", 
      RowBox[{
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"\[ImaginaryI]", " ", "a", " ", "k"}]], " ", "sd"}]}], ")"}], 
    " ", 
    RowBox[{"zs", "[", "k", "]"}], "zr"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"a5", ":=", 
   RowBox[{
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{"\[ImaginaryI]", " ", "a", " ", "k"}]], "4", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", 
           SuperscriptBox["\[ExponentialE]", 
            RowBox[{"-", 
             FractionBox[
              RowBox[{"\[ImaginaryI]", " ", "a", " ", "k"}], "2"]}]]}], " ", 
          "kk"}], "+", " ", "sd"}], ")"}], " ", "zr", " ", 
       RowBox[{"zs", "[", "k", "]"}]}], "+", " ", 
      SuperscriptBox[
       RowBox[{"zs", "[", "k", "]"}], "2"]}], ")"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"mMatSimp2", " ", "=", " ", 
    RowBox[{
     FractionBox["1", "a1"], 
     RowBox[{"(", GridBox[{
        {
         RowBox[{"a2", "+", "a3"}], 
         RowBox[{"a2", " ", "-", "a4"}]},
        {
         RowBox[{"-", 
          RowBox[{"(", 
           RowBox[{"a2", " ", "-", "a4"}], ")"}]}], 
         RowBox[{
          RowBox[{"-", "a2"}], "+", "a5"}]}
       }], ")"}]}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MatrixForm", "[", "mMat", "]"}], "==", " ", 
   RowBox[{"MatrixForm", "[", "mMatSimp2", "]"}]}], "//", 
  "FullSimplify"}]}], "Input",
 CellChangeTimes->{{3.883733587381286*^9, 3.883733626737958*^9}, {
   3.883733658047003*^9, 3.883733675928432*^9}, {3.8837337390854797`*^9, 
   3.883733769421508*^9}, {3.8837338184971313`*^9, 3.883733865777635*^9}, {
   3.8909683786893673`*^9, 3.8909684027659445`*^9}, {3.9080146789945393`*^9, 
   3.9080146875952625`*^9}, {3.908015101265821*^9, 3.908015102374703*^9}, {
   3.9080152356575365`*^9, 3.908015243999647*^9}, {3.908015605859705*^9, 
   3.908015616386714*^9}, {3.9080157247500753`*^9, 3.9080160731755724`*^9}, {
   3.9080161689856863`*^9, 3.9080161809913206`*^9}, {3.908018892707147*^9, 
   3.908018929088379*^9}, {3.908018964971922*^9, 3.9080189660259085`*^9}, {
   3.9080190055903816`*^9, 3.908019022147466*^9}, 3.9080190640771446`*^9, {
   3.908019098598214*^9, 3.908019133766382*^9}, {3.908019217868464*^9, 
   3.908019223702874*^9}, {3.9080194250754485`*^9, 3.9080194338904405`*^9}, {
   3.9107760399821215`*^9, 3.910776058712361*^9}, {3.9107760900319743`*^9, 
   3.910776137197029*^9}, {3.910776167878891*^9, 3.9107762535592794`*^9}, {
   3.910776290133401*^9, 3.9107763344052706`*^9}, {3.91077638243169*^9, 
   3.910776424062174*^9}, {3.910776789266968*^9, 3.9107768023292704`*^9}, {
   3.910778710458926*^9, 3.9107787133074164`*^9}, {3.910779975234231*^9, 
   3.910779976320225*^9}},ExpressionUUID->"d4eb31fd-9815-4c1f-96e5-\
c61f5d6eae1d"],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{3.91077997781575*^9},
 CellLabel->
  "Out[946]=",ExpressionUUID->"646cbef1-055f-469f-b21a-0f8a4801c3d3"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
WindowSize->{795, 1348},
WindowMargins->{{Automatic, -7}, {Automatic, 0}},
TaggingRules->Association["TryRealOnly" -> False],
Magnification:>1.4 Inherited,
FrontEndVersion->"12.0 for Microsoft Windows (64-bit) (April 8, 2019)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 177, 4, 40, "Input",ExpressionUUID->"801124ab-0fb5-448a-adb8-95a18c7e2d49"],
Cell[738, 26, 790, 23, 125, "Input",ExpressionUUID->"93da8c23-d7d5-458e-ad14-3e21b9a90adb"],
Cell[1531, 51, 430, 8, 69, "Input",ExpressionUUID->"b34892b9-64fb-4f01-b5cd-1ce48657d503"],
Cell[CellGroupData[{
Cell[1986, 63, 295, 4, 79, "Section",ExpressionUUID->"6a98240c-5431-415b-93e6-be8d9b7625b1"],
Cell[2284, 69, 3689, 51, 40, "Input",ExpressionUUID->"44c34d5a-456a-47e2-8767-86445beabc62"],
Cell[CellGroupData[{
Cell[5998, 124, 11619, 276, 1559, "Input",ExpressionUUID->"36dd4bb9-63dd-4176-97f7-6d4b67e210d6"],
Cell[17620, 402, 7307, 199, 220, "Output",ExpressionUUID->"23378145-af80-4611-866c-61d20178896c"]
}, Open  ]],
Cell[24942, 604, 4440, 64, 209, "Input",ExpressionUUID->"fe231724-afe8-4134-9303-0a22369706fd"],
Cell[CellGroupData[{
Cell[29407, 672, 215, 4, 75, "Subsection",ExpressionUUID->"9929bd8f-4855-4def-bdb7-41bf4112b9ff"],
Cell[CellGroupData[{
Cell[29647, 680, 8586, 193, 204, "Input",ExpressionUUID->"2dd8508d-a21d-4b1f-9d6a-86d27c563058"],
Cell[38236, 875, 429, 7, 46, "Output",ExpressionUUID->"9290dd16-5526-4666-84ce-f583cdb1c41a"]
}, Open  ]],
Cell[CellGroupData[{
Cell[38702, 887, 4853, 129, 412, "Input",ExpressionUUID->"d4eb31fd-9815-4c1f-96e5-c61f5d6eae1d"],
Cell[43558, 1018, 155, 3, 46, "Output",ExpressionUUID->"646cbef1-055f-469f-b21a-0f8a4801c3d3"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)

